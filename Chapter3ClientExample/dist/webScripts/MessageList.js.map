{"version":3,"sources":["../../webScripts/MessageList.js"],"names":["MessageList","document","Error","MessageItemFactory","require","item","getElementById","ItemFactory","renderTask","TaskCount","prototype","addItem","message","messageItem","createItem","id","items","appendChild","push","scrollToBottom","loadItem","Promise","resolve","sortList","reject","list","slice","call","sort","a","b","aDate","getElementsByClassName","bDate","innerText","updateList","messageList","forEach","element","chageSuccessStatus","index","length","itme","changeSuccessStatusMessage","result","splice","childNodes","then","bind","catch","e","console","log","chageFailureStatus","listener","indxe","chageFailureStatusMessage","clearItems","firstChild","removeChild","lastChild","scrollTop","scrollHeight","module","exports"],"mappings":"AAAA;;;;;AAKA;;AAEA,SAASA,WAAT,CAAqBC,QAArB,EAA+B;AAC7B,MAAG,EAAE,gBAAgBD,WAAlB,CAAH,EAAkC;AAChC,UAAM,IAAIE,KAAJ,CAAU,kCAAV,CAAN;AACD;AACD,MAAMC,qBAAqBC,QAAQ,sBAAR,CAA3B;AACA,OAAKC,IAAL,GAAYJ,SAASK,cAAT,CAAwB,aAAxB,CAAZ;AACA,OAAKC,WAAL,GAAmB,IAAIJ,kBAAJ,CAAuBF,QAAvB,CAAnB;AACA,OAAKO,UAAL,GAAkB,EAAlB;AACA,OAAKC,SAAL,GAAiB,CAAjB;AACD;;AAEDT,YAAYU,SAAZ,CAAsBC,OAAtB,GAAgC,UAAUC,OAAV,EAAmB;AACjD,MAAMC,cAAc,KAAKN,WAAL,CAAiBO,UAAjB,CAA4BF,OAA5B,CAApB;AACAC,cAAYE,EAAZ,GAAiB,KAAKN,SAAtB;AACAI,cAAYR,IAAZ,CAAiBU,EAAjB,GAAsB,KAAKN,SAA3B;AACA,OAAKA,SAAL;AACA,OAAKO,KAAL,CAAWC,WAAX,CAAuBJ,YAAYR,IAAnC;AACA,OAAKG,UAAL,CAAgBU,IAAhB,CAAqBL,WAArB;AACA,OAAKM,cAAL;AACA,SAAON,WAAP;AACD,CATD;AAUAb,YAAYU,SAAZ,CAAsBU,QAAtB,GAAiC,UAAUR,OAAV,EAAmB;AAClD,MAAMC,cAAc,KAAKN,WAAL,CAAiBa,QAAjB,CAA0BR,OAA1B,CAApB;;AAEA,OAAKI,KAAL,CAAWC,WAAX,CAAuBJ,YAAYR,IAAnC;AACA,SAAOgB,QAAQC,OAAR,EAAP;AACD,CALD;;AAOAtB,YAAYU,SAAZ,CAAsBa,QAAtB,GAAiC,UAAUP,KAAV,EAAiB;AAChD,SAAO,IAAIK,OAAJ,CAAY,UAACC,OAAD,EAASE,MAAT,EAAkB;AACnC,QAAG,CAACR,KAAJ,EAAW,OAAOQ,QAAP;AACX,QAAMC,OAAO,GAAGC,KAAH,CAASC,IAAT,CAAcX,KAAd,EAAqBY,IAArB,CAA0B,UAAUC,CAAV,EAAaC,CAAb,EAAgB;AACrD,UAAMC,QAAQF,EAAEG,sBAAF,CAAyB,oBAAzB,EAA+C,CAA/C,CAAd;AACA,UAAMC,QAAQH,EAAEE,sBAAF,CAAyB,oBAAzB,EAA+C,CAA/C,CAAd;AACA,aAAOD,MAAMG,SAAN,GAAkBD,MAAMC,SAAxB,GAAmC,CAAnC,GAAqC,CAAC,CAA7C;AACD,KAJY,CAAb;AAKAZ,YAAQG,IAAR;AACD,GARM,CAAP;AASD,CAVD;;AAYAzB,YAAYU,SAAZ,CAAsByB,UAAtB,GAAmC,UAAUnB,KAAV,EAAiB;AAAA;;AAClD,MAAMoB,cAAc,KAAKpB,KAAzB;AACAA,QAAMqB,OAAN,CAAc,UAACC,OAAD,EAAW;AACvBF,gBAAYnB,WAAZ,CAAwBqB,OAAxB;AACA,UAAKnB,cAAL;AACD,GAHD;AAID,CAND;AAOAnB,YAAYU,SAAZ,CAAsB6B,kBAAtB,GAA2C,UAAU3B,OAAV,EAAmB;AAC5D,OAAI,IAAI4B,QAAQ,CAAhB,EAAmBA,QAAQ,KAAKhC,UAAL,CAAgBiC,MAA3C,EAAmDD,OAAnD,EAA2D;AACzD,QAAG,KAAKhC,UAAL,CAAgBgC,KAAhB,EAAuBzB,EAAvB,KAA8BH,QAAQ8B,IAAR,CAAa3B,EAA9C,EAAiD;AAC/C,WAAKR,WAAL,CAAiBoC,0BAAjB,CAA4C,KAAKnC,UAAL,CAAgBgC,KAAhB,CAA5C,EAAmE5B,QAAQgC,MAA3E;AACA,WAAKpC,UAAL,CAAgBqC,MAAhB,CAAuBL,KAAvB,EAA6B,CAA7B;AACA,WAAK/B,SAAL;AACA,WAAKc,QAAL,CAAc,KAAKP,KAAL,CAAW8B,UAAzB,EACGC,IADH,CACQ,KAAKZ,UAAL,CAAgBa,IAAhB,CAAqB,IAArB,CADR,EAEGC,KAFH,CAES,UAACC,CAAD,EAAK;AACVC,gBAAQC,GAAR,CAAYF,CAAZ;AACD,OAJH;AAKD;AACF;AACF,CAbD;AAcAlD,YAAYU,SAAZ,CAAsB2C,kBAAtB,GAA2C,UAAUzC,OAAV,EAAmB0C,QAAnB,EAA6B;AACtE,OAAI,IAAId,QAAO,CAAf,EAAmBe,QAAM,KAAK/C,UAAL,CAAgBiC,MAAzC,EAAiDD,KAAjD,EAAuD;AACrD,QAAG,KAAKhC,UAAL,CAAgBgC,KAAhB,EAAuBzB,EAAvB,KAA8BH,QAAQ8B,IAAR,CAAa3B,EAA9C,EAAiD;AAC/C,WAAKR,WAAL,CAAiBiD,yBAAjB,CAA2C,KAAKhD,UAAL,CAAgBgC,KAAhB,CAA3C,EAAkE5B,QAAQgC,MAA1E,EAAiFU,QAAjF;AACA;AACD;AACF;AACF,CAPD;AAQAtD,YAAYU,SAAZ,CAAsB+C,UAAtB,GAAmC,YAAY;AAC7C,MAAMzC,QAAQ,KAAKA,KAAnB;AACA,SAAO,IAAIK,OAAJ,CAAY,UAACC,OAAD,EAASE,MAAT,EAAkB;AACnC,QAAG,CAACR,KAAJ,EAAW,OAAOQ,QAAP;AACX,WAAMR,MAAM0C,UAAZ,EAAuB;AACrB1C,YAAM2C,WAAN,CAAkB3C,MAAM4C,SAAxB;AACD;AACDtC;AACD,GANM,CAAP;AAOD,CATD;;AAWAtB,YAAYU,SAAZ,CAAsBS,cAAtB,GAAuC,YAAY;AACjD,OAAKH,KAAL,CAAW6C,SAAX,GAAuB,KAAK7C,KAAL,CAAW8C,YAAlC;AACD,CAFD;;AAIAC,OAAOC,OAAP,GAAiBhE,WAAjB","file":"MessageList.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 9. 17.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\nfunction MessageList(document) {\n  if(!(this instanceof MessageList)){\n    throw new Error('must be created with new keyword');\n  }\n  const MessageItemFactory = require('./MessageItemFactory');\n  this.item = document.getElementById('messageList');\n  this.ItemFactory = new MessageItemFactory(document);\n  this.renderTask = [];\n  this.TaskCount = 0;\n}\n\nMessageList.prototype.addItem = function (message) {\n  const messageItem = this.ItemFactory.createItem(message);\n  messageItem.id = this.TaskCount;\n  messageItem.item.id = this.TaskCount;\n  this.TaskCount++;\n  this.items.appendChild(messageItem.item);\n  this.renderTask.push(messageItem);\n  this.scrollToBottom();\n  return messageItem;\n};\nMessageList.prototype.loadItem = function (message) {\n  const messageItem = this.ItemFactory.loadItem(message);\n\n  this.items.appendChild(messageItem.item);\n  return Promise.resolve();\n};\n\nMessageList.prototype.sortList = function (items) {\n  return new Promise((resolve,reject)=>{\n    if(!items) return reject();\n    const list = [].slice.call(items).sort(function (a, b) {\n      const aDate = a.getElementsByClassName('messageElementDate')[0];\n      const bDate = b.getElementsByClassName('messageElementDate')[0];\n      return aDate.innerText > bDate.innerText? 1:-1\n    });\n    resolve(list);\n  });\n};\n\nMessageList.prototype.updateList = function (items) {\n  const messageList = this.items;\n  items.forEach((element)=>{\n    messageList.appendChild(element);\n    this.scrollToBottom();\n  });\n};\nMessageList.prototype.chageSuccessStatus = function (message) {\n  for(let index = 0; index < this.renderTask.length; index++){\n    if(this.renderTask[index].id === message.itme.id){\n      this.ItemFactory.changeSuccessStatusMessage(this.renderTask[index],message.result);\n      this.renderTask.splice(index,1);\n      this.TaskCount--;\n      this.sortList(this.items.childNodes)\n        .then(this.updateList.bind(this))\n        .catch((e)=>{\n          console.log(e);\n        })\n    }\n  }\n};\nMessageList.prototype.chageFailureStatus = function (message, listener) {\n  for(let index =0 ; indxe<this.renderTask.length; index){\n    if(this.renderTask[index].id === message.itme.id){\n      this.ItemFactory.chageFailureStatusMessage(this.renderTask[index],message.result,listener);\n      return;\n    }\n  }\n};\nMessageList.prototype.clearItems = function () {\n  const items = this.items;\n  return new Promise((resolve,reject)=>{\n    if(!items) return reject();\n    while(items.firstChild){\n      items.removeChild(items.lastChild);\n    }\n    resolve();\n  });\n};\n\nMessageList.prototype.scrollToBottom = function () {\n  this.items.scrollTop = this.items.scrollHeight;\n};\n\nmodule.exports = MessageList;"]}