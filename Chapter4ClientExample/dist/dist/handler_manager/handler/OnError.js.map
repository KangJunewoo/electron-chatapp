{"version":3,"sources":["../../../handler_manager/handler/OnError.js"],"names":["module","exports","socket","win","TokenManager","err","console","log","axios","require","httpInstance","create","baseURL","tokenRequest","token","getToken","id","getId","get","headers","then","response","setToken","data","io","opts","query","webContents","send","catch","e"],"mappings":"AAAA;;;;;AAKA;;AAEAA,OAAOC,OAAP,GAAiB,UAAUC,MAAV,EAAkBC,GAAlB,EAAuBC,YAAvB,EAAqCC,GAArC,EAA0C;AACzDC,UAAQC,GAAR,CAAY,qBAAqBF,GAAjC;AACA,MAAIG,QAAQC,QAAQ,OAAR,CAAZ;AACA,MAAIC,eAAeF,MAAMG,MAAN,CAAa,EAAEC,SAAS,4CAAX,EAAb,CAAnB;;AAEA,MAAIC,eAAe,SAASA,YAAT,GAAwB;AACzC,QAAIC,QAAQV,aAAaW,QAAb,EAAZ;AACA,QAAIC,KAAKZ,aAAaa,KAAb,EAAT;AACA,WAAOP,aAAaQ,GAAb,CAAiB,qBAAqBF,EAAtC,EAA0C,EAAEG,SAAS,EAAE,kBAAkBL,KAApB,EAAX,EAA1C,CAAP;AACD,GAJD;;AAMA,MAAIT,QAAQ,cAAZ,EAA4B;AAC1BQ,mBAAeO,IAAf,CAAoB,UAAUC,QAAV,EAAoB;AACtCjB,mBAAakB,QAAb,CAAsBD,SAASE,IAAT,CAAcT,KAApC;AACAZ,aAAOsB,EAAP,CAAUC,IAAV,CAAeC,KAAf,GAAuB,EAAEZ,OAAOV,aAAaW,QAAb,EAAT,EAAvB;AACAZ,UAAIwB,WAAJ,CAAgBC,IAAhB,CAAqB,yBAArB;AACD,KAJD,EAIGC,KAJH,CAIS,UAAUC,CAAV,EAAa;AACpB3B,UAAIwB,WAAJ,CAAgBC,IAAhB,CAAqB,yBAArB;AACD,KAND;AAOD,GARD,MAQO;AACLzB,QAAIwB,WAAJ,CAAgBC,IAAhB,CAAqB,mBAArB;AACD;AACF,CAtBD;AAuBA","file":"OnError.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 7. 3.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\nmodule.exports = function (socket, win, TokenManager, err) {\n  console.log('socket error is ' + err);\n  var axios = require('axios');\n  var httpInstance = axios.create({ baseURL: 'http://electronexampleserver.mybluemix.net' });\n\n  var tokenRequest = function tokenRequest() {\n    var token = TokenManager.getToken();\n    var id = TokenManager.getId();\n    return httpInstance.get('/users/token?id=' + id, { headers: { 'x-access-token': token } });\n  };\n\n  if (err === 'TokenRefresh') {\n    tokenRequest().then(function (response) {\n      TokenManager.setToken(response.data.token);\n      socket.io.opts.query = { token: TokenManager.getToken() };\n      win.webContents.send('tokenRefreshing-Success');\n    }).catch(function (e) {\n      win.webContents.send('tokenRefreshing-Failure');\n    });\n  } else {\n    win.webContents.send('RedirectLoginPage');\n  }\n};\n//# sourceMappingURL=OnError.js.map"]}