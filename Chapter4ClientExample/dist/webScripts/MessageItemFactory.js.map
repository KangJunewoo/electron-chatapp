{"version":3,"sources":["../../webScripts/MessageItemFactory.js"],"names":["MessageItemFactory","document","Error","moment","require","utcOffset","locale","undefined","prototype","setLocale","createItem","message","item","createElement","itemDiv","messageElementProfile","resendButton","messageElementDate","messageContent","className","innerText","sender","id","setAttribute","utc","Date","now","format","appendChild","loadItem","CreatedAt","changeSuccessStatusMessage","sendRetryValidate","classes","split","i","indexOf","classList","toggle","_id","changeFailureStatusMessage","listener","addEventListener","createRequestFriendItem","requestFriendId","FriendShipConfirmButton","FriendShipCancelButton","elementLoader","value","createFriendItem","createRoomItem","room","roomName","module","exports"],"mappings":"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","file":"MessageItemFactory.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 9. 18.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\nfunction MessageItemFactory(document) {\n  if(!(this instanceof MessageItemFactory)){\n    throw new Error('must be created with new keyword');\n  }\n  const moment = require('moment');\n  this.document = document;\n  this.moment = moment;\n  this.utcOffset = moment().utcOffset();\n  this.locale = undefined;\n  \n}\n\nMessageItemFactory.prototype.setLocale = function (locale) {\n  this.locale = locale;\n  this.moment.locale(locale);\n  return this.locale;\n}\n\nMessageItemFactory.prototype.createItem = function (message) {\n  const item = this.document.createElement('li');\n  const itemDiv = this.document.createElement('div');\n  const messageElementProfile = this.document.createElement('p');\n  const resendButton = this.document.createElement('div');\n  const messageElementDate = this.document.createElement('p');\n  const messageContent = this.document.createElement('p');\n\n  item.className = 'messageElement';\n  resendButton.className = 'messageElementReSendButton';\n  messageElementProfile.className = 'messageElementProfile';\n  messageElementDate.className = 'messageElementDate';\n  messageContent.className = 'messageContent';\n\n  messageElementProfile.innerText = message.sender.id;\n  resendButton.innerText = '재전송';\n  messageElementDate.setAttribute('data-value',this.moment.utc(Date.now()).utcOffset(this.utcOffset).format('x'));\n  messageElementDate.innerText = this.moment.utc(Date.now()).utcOffset(this.utcOffset).format();\n  messageContent.innerText = message.message;\n\n  itemDiv.appendChild(messageElementProfile);\n  itemDiv.appendChild(messageElementDate);\n  itemDiv.appendChild(resendButton);\n  itemDiv.appendChild(messageContent);\n  item.appendChild(itemDiv);\n  return {\n    item:item,\n    itemDiv:itemDiv,\n    resendButton:resendButton,\n    messageElementProfile:messageElementProfile,\n    messageElementDate:messageElementDate,\n    messageContent:messageContent\n  };\n};\n\nMessageItemFactory.prototype.loadItem = function (message) {\n  const item = this.document.createElement('li');\n  const itemDiv = this.document.createElement('div');\n  const messageElementProfile = this.document.createElement('p');\n  const resendButton = this.document.createElement('div');\n  const messageElementDate = this.document.createElement('p');\n  const messageContent = this.document.createElement('p');\n\n  item.className = 'messageElement';\n  resendButton.className = 'messageElementReSendButton';\n  messageElementProfile.className = 'messageElementProfile';\n  messageElementDate.className = 'messageElementDate';\n  messageContent.className = 'messageContent';\n\n  messageElementProfile.innerText = message.sender.id;\n  resendButton.innerText = '재전송';\n  messageElementDate.setAttribute('data-value',this.moment.utc(message.CreatedAt).utcOffset(this.utcOffset).format('x'));\n  messageElementDate.innerText = this.moment.utc(message.CreatedAt).utcOffset(this.utcOffset).format();\n  messageContent.innerText = message.message;\n\n  itemDiv.appendChild(messageElementProfile);\n  itemDiv.appendChild(messageElementDate);\n  itemDiv.appendChild(resendButton);\n  itemDiv.appendChild(messageContent);\n  item.appendChild(itemDiv);\n  return item;\n};\n\nMessageItemFactory.prototype.changeSuccessStatusMessage = function (item, message) {\n  const sendRetryValidate = (item)=>{\n    const classes = item.className.split(' ');\n    const i = classes.indexOf('show');\n    if(i>=0) item.classList.toggle('show');\n  }\n  item.item._id = message._id;\n  sendRetryValidate(item.resendButton);\n  item.messageElementProfile.innerText = message.sender.id;\n  item.messageElementDate.setAttribute('data-value',this.moment.utc(message.CreatedAt).utcOffset(this.utcOffset).format('x'));\n  item.messageElementDate.innerText = this.moment.utc(message.CreatedAt).utcOffset(this.utcOffset).format();\n  item.messageContent.innerText = message.message;\n  return item;\n};\nMessageItemFactory.prototype.changeFailureStatusMessage = function (item, message, listener) {\n  item.resendButton.classList.toggle('show');\n  item.resendButton.addEventListener('click',listener);\n  return item;\n};\nMessageItemFactory.prototype.createRequestFriendItem = function (message) {\n  const item = this.document.createElement('li');\n  const requestFriendId = this.document.createElement('p');\n  const FriendShipConfirmButton = this.document.createElement('button');\n  const FriendShipCancelButton = this.document.createElement('button');\n  const elementLoader = this.document.createElement('div');\n\n  item.id = message._id;\n\n  item.className = 'requestElement';\n  requestFriendId.className = 'requestFriendId';\n  FriendShipConfirmButton.className = 'FriendShipButton';\n  FriendShipCancelButton.className = 'FriendShipButton';\n  elementLoader.className = 'elementLoader';\n\n  requestFriendId.innerText = message.id;\n  FriendShipCancelButton.innerText = '수락';\n  FriendShipConfirmButton.value = 1;\n  FriendShipCancelButton.innerText = '거절';\n  FriendShipCancelButton.value = 0;\n\n  item.appendChild(requestFriendId);\n  item.appendChild(FriendShipConfirmButton);\n  item.appendChild(FriendShipCancelButton);\n  item.appendChild(elementLoader);\n  return item;\n\n};\n\nMessageItemFactory.prototype.createFriendItem = function (message) {\n  const item = this.document.createElement('li');\n  const requestFriendId = this.document.createElement('p');\n  const FriendShipCancelButton = this.document.createElement('button');\n  const elementLoader = this.document.createElement('div');\n\n  item.id = message._id;\n\n  item.className = 'friendElement';\n  requestFriendId.className = 'friendId';\n  FriendShipCancelButton.className = 'cancelFriendShipButton';\n  elementLoader.className = 'elementLoader';\n\n  requestFriendId.innerText = message.id;\n  FriendShipCancelButton.innerText = '친구 삭제';\n\n  item.appendChild(requestFriendId);\n  item.appendChild(FriendShipCancelButton);\n  item.appendChild(elementLoader);\n  return item;\n\n};\n\nMessageItemFactory.prototype.createRoomItem = function (room) {\n  const item = this.document.createElement('li');\n  item.className = 'roomButton';\n  item.id = room._id;\n  item.innerText = room.roomName;\n  return item;\n}\n\nmodule.exports = MessageItemFactory;"]}