{"version":3,"sources":["../../../handler_manager/handler/OnError.js"],"names":["module","exports","socket","win","TokenManager","err","console","log","axios","require","httpInstance","create","baseURL","tokenRequest","token","getToken","id","getId","get","headers","then","response","setToken","data","io","opts","query","webContents","send","catch","e"],"mappings":"AAAA;;;;;AAKA;;AAEAA,OAAOC,OAAP,GAAiB,UAACC,MAAD,EAASC,GAAT,EAAcC,YAAd,EAA4BC,GAA5B,EAAkC;AACjDC,UAAQC,GAAR,sBAA+BF,GAA/B;AACA,MAAMG,QAAQC,QAAQ,OAAR,CAAd;AACA,MAAMC,eAAeF,MAAMG,MAAN,CAAa,EAACC,SAAQ,4CAAT,EAAb,CAArB;;AAEA,MAAMC,eAAe,SAAfA,YAAe,GAAI;AACvB,QAAMC,QAAQV,aAAaW,QAAb,EAAd;AACA,QAAMC,KAAKZ,aAAaa,KAAb,EAAX;AACA,WAAOP,aAAaQ,GAAb,CAAiB,qBAAmBF,EAApC,EAAuC,EAACG,SAAQ,EAAC,kBAAiBL,KAAlB,EAAT,EAAvC,CAAP;AACD,GAJD;;AAMA,MAAGT,QAAM,cAAT,EAAwB;AACtBQ,mBACGO,IADH,CACQ,UAACC,QAAD,EAAY;AAChBjB,mBAAakB,QAAb,CAAsBD,SAASE,IAAT,CAAcT,KAApC;AACAZ,aAAOsB,EAAP,CAAUC,IAAV,CAAeC,KAAf,GAAuB,EAACZ,OAAMV,aAAaW,QAAb,EAAP,EAAvB;AACAZ,UAAIwB,WAAJ,CAAgBC,IAAhB,CAAqB,yBAArB;AACD,KALH,EAMGC,KANH,CAMS,UAACC,CAAD,EAAK;AACV3B,UAAIwB,WAAJ,CAAgBC,IAAhB,CAAqB,yBAArB;AACD,KARH;AASD,GAVD,MAUK;AACHzB,QAAIwB,WAAJ,CAAgBC,IAAhB,CAAqB,mBAArB;AACD;AACF,CAxBD","file":"OnError.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 7. 3.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\nmodule.exports = (socket, win, TokenManager, err)=>{\n  console.log(`socket error is ${err}`);\n  const axios = require('axios');\n  const httpInstance = axios.create({baseURL:'http://electronexampleserver.mybluemix.net'});\n\n  const tokenRequest = ()=>{\n    const token = TokenManager.getToken();\n    const id = TokenManager.getId();\n    return httpInstance.get('/users/token?id='+id,{headers:{'x-access-token':token}});\n  };\n\n  if(err==='TokenRefresh'){\n    tokenRequest()\n      .then((response)=>{\n        TokenManager.setToken(response.data.token);\n        socket.io.opts.query = {token:TokenManager.getToken()};\n        win.webContents.send('tokenRefreshing-Success');\n      })\n      .catch((e)=>{\n        win.webContents.send('tokenRefreshing-Failure');\n      })\n  }else{\n    win.webContents.send('RedirectLoginPage');\n  }\n};"]}