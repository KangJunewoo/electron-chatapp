{"version":3,"sources":["../../../../socketRoutes/InviteUser/middleware/pushUserToRoom.js"],"names":["module","exports","result","message","Room","require","Task","targetUser","Promise","reject","Error","query","_id","roomId","update","$push","participants","options","new","rooms","push","save","findOneAndUpdate","exec","resolve","all","then","taskResults","catch","errors"],"mappings":"AAAA;;;;;AAKA;;AAEAA,OAAOC,OAAP,GAAiB,UAACC,MAAD,EAAQC,OAAR,EAAkB;AACjC,MAAMC,OAAOC,QAAQ,qBAAR,CAAb;AACA,MAAMC,OAAO,EAAb;AACA,MAAG,CAACJ,OAAOK,UAAX,EAAsB,OAAOC,QAAQC,MAAR,CAAe,IAAIC,KAAJ,CAAU,gBAAV,CAAf,CAAP;AACtB,MAAMC,QAAQ;AACZC,SAAIT,QAAQU;AADA,GAAd;AAGA,MAAMC,SAAS;AACbC,WAAM;AACJC,oBAAad,OAAOK,UAAP,CAAkBK;AAD3B;AADO,GAAf;AAKA,MAAMK,UAAU;AACdC,SAAI;AADU,GAAhB;AAGAhB,SAAOK,UAAP,CAAkBY,KAAlB,CAAwBC,IAAxB,CAA6BjB,QAAQU,MAArC;AACAP,OAAKc,IAAL,CAAUlB,OAAOK,UAAP,CAAkBc,IAAlB,EAAV;AACAf,OAAKc,IAAL,CAAUhB,KAAKkB,gBAAL,CAAsBX,KAAtB,EAA4BG,MAA5B,EAAmCG,OAAnC,EAA4CM,IAA5C,EAAV;AACA,SAAO,IAAIf,OAAJ,CAAY,UAACgB,OAAD,EAASf,MAAT,EAAkB;AACnCD,YAAQiB,GAAR,CAAYnB,IAAZ,EACGoB,IADH,CACQ,UAACC,WAAD,EAAe;AACnBzB,aAAOyB,WAAP,GAAqBA,WAArB;AACA,aAAOH,QAAQtB,MAAR,CAAP;AACD,KAJH,EAKG0B,KALH,CAKS,UAACC,MAAD,EAAU;AACf,aAAOpB,OAAOoB,MAAP,CAAP;AACD,KAPH;AAQD,GATM,CAAP;AAUD,CA5BD","file":"pushUserToRoom.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 9. 19.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\nmodule.exports = (result,message)=>{\n  const Room = require('../../../model/Room');\n  const Task = [];\n  if(!result.targetUser)return Promise.reject(new Error('User Not Found'));\n  const query = {\n    _id:message.roomId\n  };\n  const update = {\n    $push:{\n      participants:result.targetUser._id\n    }\n  };\n  const options = {\n    new:true\n  };\n  result.targetUser.rooms.push(message.roomId);\n  Task.push(result.targetUser.save());\n  Task.push(Room.findOneAndUpdate(query,update,options).exec());\n  return new Promise((resolve,reject)=>{\n    Promise.all(Task)\n      .then((taskResults)=>{\n        result.taskResults = taskResults;\n        return resolve(result);\n      })\n      .catch((errors)=>{\n        return reject(errors);\n      });\n  });\n};"]}