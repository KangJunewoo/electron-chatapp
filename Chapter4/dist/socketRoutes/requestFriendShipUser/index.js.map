{"version":3,"sources":["../../../socketRoutes/requestFriendShipUser/index.js"],"names":["module","exports","socket","event","Verfier","require","JWTVerifier","findUser","createFindFriendTask","excuteFindFriendTask","createFriendShipTask","excuteFriendShipTask","sendSuccessAck","sendFailureAck","on","message","ack","verify","token","then","decodedUser","result","catch","error"],"mappings":"AAAA;;;;;AAKA;;AAEAA,OAAOC,OAAP,GAAiB,UAACC,MAAD,EAASC,KAAT,EAAiB;AAChC,MAAMC,UAAUC,QAAQ,qBAAR,CAAhB;AACA,MAAMC,cAAc,IAAIF,OAAJ,EAApB;AACA,MAAMG,WAAWF,QAAQ,uBAAR,CAAjB;AACA,MAAMG,uBAAuBH,QAAQ,mCAAR,CAA7B;AACA,MAAMI,uBAAuBJ,QAAQ,mCAAR,CAA7B;AACA,MAAMK,uBAAuBL,QAAQ,mCAAR,CAA7B;AACA,MAAMM,uBAAuBN,QAAQ,mCAAR,CAA7B;AACA,MAAMO,iBAAiBP,QAAQ,6BAAR,CAAvB;AACA,MAAMQ,iBAAiBR,QAAQ,6BAAR,CAAvB;AACAH,SAAOY,EAAP,CAAUX,KAAV,EAAgB,UAACY,OAAD,EAASC,GAAT,EAAe;;AAE7BV,gBAAYW,MAAZ,CAAmBf,MAAnB,EAA0Ba,QAAQG,KAAlC,EACGC,IADH,CACQ,UAACC,WAAD,EAAe;AACnB,aAAOb,SAASa,WAAT,CAAP;AACD,KAHH,EAIGD,IAJH,CAIQ,UAACE,MAAD,EAAU;AACd,aAAOb,qBAAqBa,MAArB,EAA4BN,OAA5B,CAAP;AACD,KANH,EAOGI,IAPH,CAOQ,UAACE,MAAD,EAAU;AACd,aAAOZ,qBAAqBY,MAArB,CAAP;AACD,KATH,EAUGF,IAVH,CAUQ,UAACE,MAAD,EAAU;AACd,aAAOX,qBAAqBW,MAArB,CAAP;AACD,KAZH,EAaGF,IAbH,CAaQ,UAACE,MAAD,EAAU;AACd,aAAOV,qBAAqBU,MAArB,CAAP;AACD,KAfH,EAgBGF,IAhBH,CAgBQ,UAACE,MAAD,EAAU;AACd,aAAOT,eAAeS,MAAf,EAAsBN,OAAtB,EAA8BC,GAA9B,CAAP;AACD,KAlBH,EAmBGM,KAnBH,CAmBS,UAACC,KAAD,EAAS;AACd,aAAOV,eAAeU,KAAf,EAAqBR,OAArB,EAA6BC,GAA7B,CAAP;AACD,KArBH;AAsBD,GAxBD;AAyBD,CAnCD","file":"index.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 9. 19.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\nmodule.exports = (socket, event)=>{\n  const Verfier = require('../../util/Verifier');\n  const JWTVerifier = new Verfier();\n  const findUser = require('./middleware/findUser');\n  const createFindFriendTask = require('./middleware/createFindFriendTask');\n  const excuteFindFriendTask = require('./middleware/excuteFindFriendTask');\n  const createFriendShipTask = require('./middleware/createFriendShipTask');\n  const excuteFriendShipTask = require('./middleware/excuteFriendShipTask');\n  const sendSuccessAck = require('./middleware/sendSuccessAck');\n  const sendFailureAck = require('./middleware/sendFailureAck');\n  socket.on(event,(message,ack)=>{\n\n    JWTVerifier.verify(socket,message.token)\n      .then((decodedUser)=>{\n        return findUser(decodedUser);\n      })\n      .then((result)=>{\n        return createFindFriendTask(result,message);\n      })\n      .then((result)=>{\n        return excuteFindFriendTask(result);\n      })\n      .then((result)=>{\n        return createFriendShipTask(result);\n      })\n      .then((result)=>{\n        return excuteFriendShipTask(result);\n      })\n      .then((result)=>{\n        return sendSuccessAck(result,message,ack);\n      })\n      .catch((error)=>{\n        return sendFailureAck(error,message,ack);\n      })\n  });\n};"]}