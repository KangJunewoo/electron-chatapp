{"version":3,"sources":["../../../../routes/middleware/user/signin.js"],"names":["exports","createUser","req","res","next","UserModel","require","bcrypt","body","id","password","console","log","error","Error","status","generateStrictPassword","salt","hash","strictPassword","User","CreatedUser","OnError","genSalt","then","catch","saveUser","save","user","responseToUser","json"],"mappings":"AAAA;;;;;AAKA;;AAGAA,QAAQC,UAAR,GAAqB,UAACC,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAgB;AACnC,MAAMC,YAAYC,QAAQ,qBAAR,CAAlB;AACA,MAAMC,SAASD,QAAQ,QAAR,CAAf;AAFmC,kBAGbJ,IAAIM,IAHS;AAAA,MAG5BC,EAH4B,aAG5BA,EAH4B;AAAA,MAGzBC,QAHyB,aAGzBA,QAHyB;;;AAKnCC,UAAQC,GAAR,CAAYV,IAAIM,IAAhB;AACA,MAAG,CAACC,EAAJ,EAAO;AACL,QAAMI,QAAQ,IAAIC,KAAJ,CAAU,aAAV,CAAd;AACAD,UAAME,MAAN,GAAe,GAAf;AACA,WAAOX,KAAKS,KAAL,CAAP;AAED,GALD,MAKM,IAAG,CAACH,QAAJ,EAAa;AACjB,QAAMG,SAAQ,IAAIC,KAAJ,CAAU,aAAV,CAAd;AACAD,WAAME,MAAN,GAAe,GAAf;AACA,WAAOX,KAAKS,MAAL,CAAP;AACD;AACD,MAAMG,yBAAyB,SAAzBA,sBAAyB,CAACC,IAAD,EAAQ;AACrC,WAAOV,OAAOW,IAAP,CAAYR,QAAZ,EAAqBO,IAArB,CAAP;AACD,GAFD;AAGA,MAAMhB,aAAa,SAAbA,UAAa,CAACkB,cAAD,EAAkB;AACnC,QAAMC,OAAO,IAAIf,SAAJ,CAAc;AACzBI,UAAGA,EADsB;AAEzBC,gBAASS;AAFgB,KAAd,CAAb;AAIAjB,QAAImB,WAAJ,GAAkBD,IAAlB;AACAhB;AACD,GAPD;AAQA,MAAMkB,UAAU,SAAVA,OAAU,CAACT,KAAD,EAAS;AACvB,WAAOT,KAAKS,KAAL,CAAP;AACD,GAFD;AAGAN,SAAOgB,OAAP,CAAe,EAAf,EACGC,IADH,CACQR,sBADR,EAEGQ,IAFH,CAEQvB,UAFR,EAGGwB,KAHH,CAGSH,OAHT;AAKD,CAnCD;;AAqCAtB,QAAQ0B,QAAR,GAAmB,UAACxB,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAgB;;AAEjC,MAAMkB,UAAU,SAAVA,OAAU,CAACT,KAAD,EAAS;AACvB,WAAOT,KAAKS,KAAL,CAAP;AACD,GAFD;AAGAX,MAAImB,WAAJ,CAAgBM,IAAhB,GACGH,IADH,CACQ,UAACI,IAAD,EAAQ;AACZ1B,QAAImB,WAAJ,GAAkBO,IAAlB;AACA,WAAOxB,MAAP;AACD,GAJH,EAKGqB,KALH,CAKSH,OALT;AAMD,CAXD;AAYAtB,QAAQ6B,cAAR,GAAyB,UAAC3B,GAAD,EAAKC,GAAL,EAASC,IAAT,EAAgB;AACvCD,MAAI2B,IAAJ,CAAS5B,IAAImB,WAAb;AACD,CAFD","file":"signin.js","sourcesContent":["/**\n * Created by kishe56@gmail.com on 2018. 9. 18.\n * Blog : https://kishe89.github.io\n * Github : https://github.com/kishe89\n */\n'use strict';\n\n\nexports.createUser = (req,res,next)=>{\n  const UserModel = require('../../../model/User');\n  const bcrypt = require('bcrypt');\n  const {id,password} = req.body;\n\n  console.log(req.body);\n  if(!id){\n    const error = new Error(\"Bad Request\");\n    error.status = 400;\n    return next(error);\n\n  }else if(!password){\n    const error = new Error(\"Bad Request\");\n    error.status = 400;\n    return next(error);\n  }\n  const generateStrictPassword = (salt)=>{\n    return bcrypt.hash(password,salt);\n  };\n  const createUser = (strictPassword)=>{\n    const User = new UserModel({\n      id:id,\n      password:strictPassword\n    });\n    req.CreatedUser = User;\n    next();\n  };\n  const OnError = (error)=>{\n    return next(error);\n  };\n  bcrypt.genSalt(13)\n    .then(generateStrictPassword)\n    .then(createUser)\n    .catch(OnError)\n\n};\n\nexports.saveUser = (req,res,next)=>{\n\n  const OnError = (error)=>{\n    return next(error);\n  };\n  req.CreatedUser.save()\n    .then((user)=>{\n      req.CreatedUser = user;\n      return next();\n    })\n    .catch(OnError)\n};\nexports.responseToUser = (req,res,next)=>{\n  res.json(req.CreatedUser);\n};"]}